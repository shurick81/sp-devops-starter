Vagrant.configure(2) do |config|
    config.vm.communicator = "winrm"
    config.winrm.username = "administrator"
    config.winrm.password = "Fractalsol"
    config.winrm.transport = :plaintext 
    config.winrm.basic_auth_only = true
    config.vm.synced_folder ".", "/vagrant", disabled: true
    config.vm.define "AD01" do | vm_config |
        vm_config.vm.hostname = "AD01"
        vm_config.vm.box = "sp-win2012r2-ad"
        vm_config.vm.network :private_network, ip: "192.168.52.128", gateway: "192.168.52.1"
        vm_config.vm.network "forwarded_port", guest: 3389, host: 13390, auto_correct: true
        vm_config.vm.provision :shell, path: "../spdomain.ps1"
        vm_config.vm.provision "reload"
        vm_config.vm.provision :shell, path: "../spdomain.ps1"
        vm_config.vm.provider "virtualbox" do |vb|
            #vb.gui = true
            vb.memory = "1024"
            vb.cpus = 2
        end
        vm_config.vm.boot_timeout = 600
    end
    config.vm.define "DBWEBCODE01" do | vm_config |
        vm_config.vm.hostname = "DBWEBCODE01"
        vm_config.vm.box = "sp-win2012r2-db-web"
        vm_config.vm.network :private_network, ip: "192.168.52.129", gateway: "192.168.52.1"
        vm_config.vm.network "forwarded_port", guest: 3389, host: 13391, auto_correct: true
        vm_config.vm.provision :shell, path: "../domainclient.ps1"
        vm_config.vm.provision "reload"
        vm_config.vm.provision :shell, path: "../domainclientgroups.ps1"
        vm_config.vm.provision :shell, path: "../xcredclient.ps1"
        vm_config.vm.provision :shell, path: "../jre8.ps1"        
        vm_config.vm.provision :shell, path: "../joinslave.ps1"        
        vm_config.vm.provider "virtualbox" do |vb|
            #vb.gui = true
            vb.memory = "12288"
            vb.cpus = 8
        end
        vm_config.vm.boot_timeout = 600
    end
end